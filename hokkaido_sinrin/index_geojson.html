
<!doctype html>
<html lang="en">
    <head>
        <link rel="stylesheet" href="https://koukita.github.io/opendata/hodmap/css/leaflet.css">
        <link rel="stylesheet" href="https://koukita.github.io/opendata/hodmap/css/qgis2web.css">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" /><!--現在地ボタンのアイコンを表示するのに必要-->
        <link href="https://koukita.github.io/opendata/hodmap/css/L.Control.Locate.min.css" rel="stylesheet" /><!--現在地を表示するのに必要-->
        <style>
        #map {
          width: 100%;
          height: 700px;
          border: 1px solid #000000;
        }
        </style>
        <title>北海道の国有林、道有林の位置図</title>
    </head>
    <body>
        この地図は北海道の国有林、道有林の位置を表したものです。
        <div id="map"></div><!-- 地図表示エリア -->
        出典：国有林【<a href="https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-A45.html">国土数値情報＞国有林野データ</a>】、   
        道有林【<a href="https://www.pref.hokkaido.lg.jp/sr/dyr/DOP.html">道有林森林資源情報資料ダウンロードページ</a>】     

        <script src="https://koukita.github.io/opendata/hodmap/js/leaflet.js"></script>  <!--地図を表示するのに必要-->
        <script src="https://koukita.github.io/opendata/hodmap/js/leaflet.rotatedMarker.js"></script>  <!--地図を表示するのに必要-->
        <script src="https://koukita.github.io/opendata/hodmap/js/leaflet.pattern.js"></script>  <!--地図を表示するのに必要-->
        <script src="https://koukita.github.io/opendata/hodmap/js/leaflet-hash.js"></script>  <!--地図を表示するのに必要-->
        <script src="https://koukita.github.io/opendata/hodmap/js/jquery.min.js"></script> <!--$getJsonを実行するのに必要-->
        <script src="https://koukita.github.io/opendata/hodmap/js/L.Control.Locate.min.js"></script><!--現在地を表示するのに必要-->
        <script>

          //＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝
          //地図関係のプログラム
          //＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝

          //ハイライトの設定（マウスオーバー時に黄色にする）
          var highlightLayer;
          function highlightFeature(e) {
              highlightLayer = e.target;

              if (e.target.feature.geometry.type === 'LineString') {  //ジオメトリがラインかポリゴンか確認
                highlightLayer.setStyle({       //ラインの場合の設定
                  color: "#e2ff00",   //黄色
                });
              } else {
                highlightLayer.setStyle({       //ポリゴンの場合の設定
                  fillColor: "#e2ff00",   //黄色
                  fillOpacity: 0.7
                });
              }
          }
          
          //================================================
          //地図の表示
          //================================================
          //地理院地図            
          var m_Chiriin = new L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png', {
              attribution: "<a href='http://www.gsi.go.jp/kikakuchousei/kikakuchousei40182.html' target='_blank'>国土地理院</a>",
              opacity: 1.0,
              attribution: '地理院地図' });

          var map = L.map('map', {
               zoomControl:true, maxZoom:16, minZoom:7,  //ズームコントロール、ズームレベル
               center:[43.517,142.614],                 //初期表示の中心位置
               zoom: 7,                                  //初期表示のズームレベル
               layers: [m_Chiriin]
           });
           map.attributionControl.setPrefix(' <a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>');
           var bounds_group = new L.featureGroup([]);
           function setBounds() {
           }
           function popHokkaidoMap(feature, layer) {
               //マウスアウト、マウスオーバー時の動作
               layer.on({
                  mouseout: function(e) {
                      for (i in e.target._eventParents) {
                          e.target._eventParents[i].resetStyle(e.target);
                      }
                  },
                  mouseover: highlightFeature,
               });
               //ポップアップテーブルを作成する
               if (feature.properties['森林室名'] !== undefined){
                  var popupContent = '<table width="300">\
                      <col width="100">\
                      <col width="200">\
                        <tr>\
                            <th scope="row">森林室名</th>\
                            <td>' + String(feature.properties['森林室名']) + '</td>\
                        </tr>\
                        <tr>\
                            <th scope="row">住所</th>\
                            <td>' + String(feature.properties['住所']) + '</td>\
                        </tr>\
                        <tr>\
                            <th scope="row">電話番号</th>\
                            <td><a href="tel:"' + String(feature.properties['電話']) + '"">' + String(feature.properties['電話']) + '</a></td>\
                        </tr>\
                    </table>';
                } else if (feature.properties['森林管理署名'] !== undefined) {
                  var popupContent = '<table width="300">\
                      <col width="100">\
                      <col width="200">\
                        <tr>\
                            <th scope="row">森林管理署名</th>\
                            <td>' + String(feature.properties['森林管理署名']) + '</td>\
                        </tr>\
                        <tr>\
                            <th scope="row">住所</th>\
                            <td>' + String(feature.properties['住所']) + '</td>\
                        </tr>\
                        <tr>\
                            <th scope="row">代表電話(IP)</th>\
                            <td><a href="tel:"' + String(feature.properties['代表IP電話']) + '"">' + String(feature.properties['代表IP電話']) + '</a></td>\
                        </tr>\
                        <tr>\
                            <th scope="row">代表電話(NTT)</th>\
                            <td><a href="tel:"' + String(feature.properties['代表電話']) + '"">' + String(feature.properties['代表電話']) + '</a></td>\
                        </tr>\
                    </table>';
               
                }

               layer.bindPopup(popupContent, {maxHeight: 400});
           }

          function style_geojson01(feature) {
            return {
                pane: 'paneHokkaidoMap',        //マップペインを設定
                opacity: 1,                     //透明度
                color: 'rgba(0,0,0,1.0)',       //線の色
                dashArray: '',                  //線のスタイル：実線
                lineCap: 'butt',                //ラインの終わりの形状：フラット
                lineJoin: 'miter',              //継ぎ目スタイル：面取りしない
                weight: 2.0,                    //線の太さ
                fill: true,                     //塗りつぶしする
                fillOpacity: 0.5,               //塗りつぶし透明度
                fillColor: 'rgba(255,0,0,1.0)'  //塗りつぶし色：薄赤色
            }
              //以下は条件で分類する場合のサンプル
              //  if(String(feature.properties['発令状況'])=='発令中'){
              //      return {
              //          pane: 'paneHokkaidoMap',        //マップペインを設定
              //          opacity: 1,                     //透明度
              //          color: 'rgba(0,0,0,1.0)',       //線の色
              //          dashArray: '',                  //線のスタイル：実線
              //          lineCap: 'butt',                //ラインの終わりの形状：フラット
              //          lineJoin: 'miter',              //継ぎ目スタイル：面取りしない
              //          weight: 1.0,                    //線の太さ
              //          fill: true,                     //塗りつぶしする
              //          fillOpacity: 0.5,               //塗りつぶし透明度
              //          fillColor: 'rgba(255,0,0,1.0)'  //塗りつぶし色：薄赤色
              //      }
              //  }else{
              //      return {
              //          pane: 'paneHokkaidoMap',        //マップペインを設定
              //          opacity: 1,                     //透明度
              //          color: 'rgba(0,0,0,1.0)',       //線の色
              //          dashArray: '',                  //線のスタイル：実線
              //          lineCap: 'butt',                //ラインの終わりの形状：フラット
              //          lineJoin: 'miter',              //継ぎ目スタイル：面取りしない
              //          weight: 1.0,                    //線の太さ
              //          fill: true,                     //塗りつぶしする
              //          fillOpacity: 0.2,               //塗りつぶし透明度
              //          fillColor: 'rgba(255,255,255,1.0)'  //塗りつぶし色：白
              //      }
              //  }

           }
           function style_geojson02(feature) {
              return {
                  pane: 'paneHokkaidoMap',        //マップペインを設定
                  opacity: 1,                     //透明度
                  color: 'rgba(0,0,0,1.0)',       //線の色
                  dashArray: '',                  //線のスタイル：実線
                  lineCap: 'butt',                //ラインの終わりの形状：フラット
                  lineJoin: 'miter',              //継ぎ目スタイル：面取りしない
                  weight: 2.0,                    //線の太さ
                  fill: true,                     //塗りつぶしする
                  fillOpacity: 0.5,               //塗りつぶし透明度
                  fillColor: 'rgba(0,255,0,1.0)'  //塗りつぶし色：薄緑色
              }
            }

           map.createPane('paneHokkaidoMap');                                  //ペインの作成
           map.getPane('paneHokkaidoMap').style.zIndex = 400;                  //ペインの表示順序
           map.getPane('paneHokkaidoMap').style['mix-blend-mode'] = 'normal';  //ペインの混合モード
           
           
           //geojsonファイルを読み込んでレイヤに表示
           $.getJSON("https://koukita.github.io/opendata_websample/hokkaido_sinrin/geojson/hokkaido_doyurin_Area_4612.geojson",function(json){
               var layerHokkaidoMap = new L.geoJson(json, {
                   attribution: '',
                   pane: 'paneHokkaidoMap',
                   onEachFeature: popHokkaidoMap,
                   style: style_geojson01,
               });
               bounds_group.addLayer(layerHokkaidoMap);
               map.addLayer(layerHokkaidoMap);
               setBounds();
           });
           $.getJSON("https://koukita.github.io/opendata_websample/hokkaido_sinrin/geojson/hokkaido_kokuyurin_Area_4612.geojson",function(json){
               var layerHokkaidoMap = new L.geoJson(json, {
                   attribution: '',
                   pane: 'paneHokkaidoMap',
                   onEachFeature: popHokkaidoMap,
                   style: style_geojson02,
               });
               bounds_group.addLayer(layerHokkaidoMap);
               map.addLayer(layerHokkaidoMap);
               setBounds();
           });
            // 現在地の表示　Locate
            //参考にしたサイト：https://kita-note.com/leaflet-plugin-locatecontrol
            var option = {
                position: 'topright',
                strings: {
                    title: "現在地を表示",
                    popup: "現在地"
                },
                locateOptions: {
                    maxZoom: 13
                }
            }

            var lc = L.control.locate(option).addTo(map);

            // マップ表示時に現在地を取得
            //lc.start();  
        //＝＝地図表示のプログラムはここまで＝＝＝＝＝＝＝＝＝＝＝＝＝
            
        </script>
    </body>
</html>
